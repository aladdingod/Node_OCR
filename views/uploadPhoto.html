<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>ORC文字识别</title>
		<link rel="stylesheet" href="stylesheets/style.css" media="screen" type="text/css">
	</head>
	<body>
		<input style="display: none;" id="photoItem" name="img" type="file">
    	<button style="display: none;">submit</button>
    	<div class="uploadBtn" id="showDiv">upload</div>
    	<div class="realBtn">submit</div>
    	<div class="showResult"></div>
	</body>
	<script type="text/javascript" src="javascripts/jquery.min.js"></script>
	<script type="text/javascript">
		$("button").on("click", function (e) {
	    	e.preventDefault()
	    	var obj = new FormData();
	        obj.append("img",$("input").get(0).files[0]);
		    $.ajax({
		        url:"/uploadPhoto",
		        type:"post",
		        data:obj,
		        processData:false, // 不处理数据
		        contentType : false, // 不设置请求头
		        cache:false,
		        success:function(data){
		            var data = data.words_result;
		            var content = "";
		            for(var i=0;i<data.length;i++){
		            	$(".showResult").append('<p>'+data[i].words+'</p>');
		            }
		        }
		    })
		});
		//点击upload
		$("#showDiv").click(function(){
			$("#photoItem").trigger("click");
		});
		//点击submit
		$(".realBtn").click(function(){
			$("button").trigger("click");
		});

        // 抓取上传图片，转换代码结果，显示图片的dom
        var img_upload=document.getElementById("photoItem");
        var img_area=document.getElementById("showDiv");
        // 添加功能出发监听事件
        img_upload.addEventListener('change',readFile,false);

        function readFile(){
            var file=this.files[0];
            if(!/image\/\w+/.test(file.type)){ 
                alert("请确保文件为图像类型"); 
                return false; 
            }
            var reader=new FileReader();
            reader.readAsDataURL(file);
            reader.onload=function(){
                img_area.innerHTML = '<img style="width: 100%; vertical-align: middle;" src="'+this.result+'" alt=""/>'; 
            }
        }
	</script>
</html>
